{"version":3,"sources":["common/styled.ts","types/data.ts","hooks/useStateSelection.ts","components/Header/Logo/Logo.tsx","components/Header/Header.tsx","components/Footer/Footer.tsx","utils/debounce.ts","components/Controls/ControlledDropdown/ControlledDropdown.tsx","components/Controls/ControlledSlider/ControlledSlider.tsx","components/Controls/RendererControls/constants.ts","components/Controls/RendererControls/RendererControls.tsx","components/Controls/Controls.tsx","utils/SizedToParent.tsx","utils/useDimensions.ts","components/Chart/constants/index.ts","components/Chart/hooks/useCallbackRef.ts","utils/utils.ts","components/Chart/SVG/hooks/events.ts","components/Chart/SVG/hooks/useTooltipPositioner.ts","components/Chart/SVG/hooks/draw.ts","components/Chart/hooks/useSelectionOnNode.ts","components/Chart/SVG/BeeSwarmSVG.tsx","components/Chart/hooks/useResizeHandling.ts","components/Chart/hooks/axis.ts","components/Chart/SVG/SVGChartContainer.tsx","components/Chart/hooks/useTransformedData.ts","components/Chart/Pixi/utils/TooltipManager.ts","components/Chart/Pixi/PixiRenderer.ts","components/Chart/Pixi/PixiBeeSwarm.tsx","components/Chart/Pixi/hooks/useUpdatedData.ts","components/Chart/Pixi/hooks/usePixiInstance.ts","components/Chart/ChartContainer.tsx","components/Chart/hooks/range.ts","components/Chart/hooks/useViewportDimensions.ts","components/Chart/hooks/scales.ts","components/VisualizePage/VisualizePage.tsx","hooks/UseRendererSelection.ts","hooks/useSliderSettings.ts","components/IndexPage/IndexPage.tsx","hooks/useDogData.ts","common/theme.ts","components/App/App.tsx","index.tsx"],"names":["FilterOptions","Flexy","styled","div","Col","Page","FilterYOptions","age","posted","DogAge","DogCoat","DogGender","DogSize","DropdownYOptions","key","coat","text","gender","size","CoatYRange","Curly","Long","Medium","Short","Wire","Hairless","Unknown","GenderYRange","Male","Female","SizeYRange","Small","Large","ExtraLarge","defaultYOption","Logo","memo","Container","LogoText","src","process","alt","img","Header","HeaderStyles","HeaderText","rel","target","href","style","color","Footer","title","debounce","callback","timer","delay","args","clearTimeout","that","this","setTimeout","call","dropdownStyles","dropdown","maxWidth","root","display","fontFamily","fontSize","label","dropdownOptionText","ControlledDropdown","selectedOption","onDropDrownChange","options","Spacer","Dropdown","onChange","selectedKey","styles","Renderers","sliderStyles","slideBox","titleLabel","ControlledSlider","sliderOnChange","sliderValue","sliderSettings","Slider","min","max","step","showValue","snapToStep","value","imageSize","width","height","imageSrc","selectedImageSrc","RendererOptions","SVG","Canvas","WebGL","RendererControls","selectedRender","ChoiceGroup","Controls","yAxisFilter","onYDropDrownChange","onSliderChange","selectedMax","onRendererChange","ControlStyles","DEFAULT_STYLE","position","left","right","top","bottom","overflow","SizedToParent","sizedRef","onResize","children","className","defaultRef","useRef","ref","useMemo","dims","useState","dimensions","setDimensions","useEffect","current","rect","getBoundingClientRect","Math","floor","observer","ResizeObserver","entries","entry","newDims","contentRect","observe","disconnect","useDimensions","finalStyle","displayName","correctedMargins","useCallbackRef","element","setElement","useCallback","node","getTooltipHtml","data","name","toUpperCase","imgSrc","round","Date","toDateString","state","useHoverEvents","tooltip","details","showToolTip","postion","xPos","yPos","visibility","id","coords","innerHTML","padding","backgroundColor","border","t","transition","duration","useCircleDrawing","showData","elementSelection","select","useSelectionOnNode","onCircleMouseover","onCircleMouseout","useLayoutEffect","length","selectAll","d","join","enter","append","attr","x","yFilter","e","interrupt","y","update","exit","remove","on","defaultRadius","BeeSwarmContainer","vpHeight","vpWidth","yScale","xScale","setSvgEl","svgElementRef","setXAxisElement","xAxisElement","setYAxisElement","yAxisElement","setBeeSwarmContainerElement","BeeSwarmContainerElement","useResizeHandling","axisBottom","useXAxisTheming","axisLeft","useYAxisTheming","zIndex","role","transform","aria-label","SVGBeeSwarm","setTooltip","ChartStyle","ToolTip","useTransformedData","mappedData","reduce","acc","found","pos","find","o","bandwidth","push","Object","assign","hex","heightData","radius","maxBandwidth","hMap","rFactor","xOffset","yHeight","positive","output","k","arr","yHeightDown","maxX","mapHeight","slice","TooltipManager","toolTipElement","dogMap","updateTooltipPositioner","PixiRenderer","containerEl","renderer","pixiElement","circleTexture","nodesStage","stage","spriteKeys","Set","tweenedScale","ToolTipManagerInstance","rendererType","spriteMap","resize","setRenderer","circleTemplate","PIXI","beginFill","lineStyle","drawCircle","endFill","generateTexture","NEAREST","appendChild","view","addChild","pixiRender","antialias","transparent","forceCanvas","type","CANVAS","console","log","setTooltipElement","setDogMap","updateTransition","destroy","removeChild","forEach","sprite","posAttrs","mapSpriteProps","_data","interactive","interactiveChildren","ev","handleMouseover","handleMouseout","add","renderPixi","nodeId","stopPropagation","tint","parseInt","replace","hideTooltip","defaultColor","alpha","currentData","keys","start","startScale","requestAnimationFrame","tweenRender","undefined","now","deltaTime","percent","eased","easeCubic","finalScale","spriteQueue","nodesToAdd","currNode","spriteKey","currNodePos","prevNode","delete","visible","render","PixiBeeSwarm","setCanvasElement","canvasElement","pixiInstance","getRendererType","updateChart","useUpdatedData","containerElement","setPixiInstance","setTooltipDetails","setUpPixi","instance","PIXIinstance","usePixiInstance","PixiElement","ChartContainer","useViewportDimensions","yRange","scaleLinear","domain","range","useXScale","scaleBand","useYScale","heightMapData","chart","sizeStyles","overflowY","VisualizePage","chartDimensions","setChartDimensions","handleResize","selectedRenderer","setSelectedRenderer","option","useRendererSelection","YSelectedItem","setYSelectedItem","event","item","selection","useStateSelection","setSelectedMax","useSliderSettings","Selections","Chart","IndexPage","aggregatedDogData","setAggregatedDogData","mapDogData","setMapDogData","a","fetch","json","parseData","useDogData","Loading","frameBorder","allowFullScreen","pinkTheme","createTheme","defaultFontStyle","palette","themePrimary","themeLighterAlt","themeLighter","themeLight","themeTertiary","themeSecondary","themeDarkAlt","themeDark","themeDarker","neutralLighterAlt","neutralLighter","neutralLight","neutralQuaternaryAlt","neutralQuaternary","neutralTertiaryAlt","neutralTertiary","neutralSecondary","neutralPrimaryAlt","neutralPrimary","neutralDark","black","white","loadTheme","App","GlobalStyle","createGlobalStyle","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.3c5d54e7.chunk.js","sourcesContent":["import styled from 'styled-components'\r\n\r\nexport const Flexy = styled.div`\r\n\tflex: 1;\r\n\tdisplay: flex;\r\n`\r\n\r\nexport const Row = styled(Flexy)`\r\n\tflex-direction: row;\r\n`\r\n\r\nexport const Col = styled(Flexy)`\r\n\tflex-direction: column;\r\n`\r\n\r\nexport const Page = styled(Col)`\r\n\tposition: relative;\r\n`\r\n\r\nexport const Gutter = styled.div`\r\n\twidth: 50px;\r\n`\r\n","import { IDropdownOption } from '@fluentui/react'\r\n\r\nexport enum FilterOptions {\r\n\tage = 'age',\r\n\tposted = 'posted',\r\n}\r\n\r\nexport const DropdownXOptions: IDropdownOption[] = [\r\n\t{\r\n\t\tkey: FilterOptions.age,\r\n\t\ttext: FilterOptions.age,\r\n\t},\r\n\t{\r\n\t\tkey: FilterOptions.posted,\r\n\t\ttext: 'date posted on petFinder',\r\n\t},\r\n]\r\n\r\nexport enum FilterYOptions {\r\n\tcoat = 'coat',\r\n\tgender = 'gender',\r\n\tsize = 'size',\r\n}\r\n\r\nexport const DropdownYOptions: IDropdownOption[] = [\r\n\t{\r\n\t\tkey: FilterYOptions.coat,\r\n\t\ttext: FilterYOptions.coat,\r\n\t},\r\n\t{\r\n\t\tkey: FilterYOptions.gender,\r\n\t\ttext: FilterYOptions.gender,\r\n\t},\r\n\t{\r\n\t\tkey: FilterYOptions.size,\r\n\t\ttext: FilterYOptions.size,\r\n\t},\r\n]\r\n\r\nexport enum DogAge {\r\n\tSenior = 'Senior',\r\n\tAdult = 'Adult',\r\n\tYoung = 'Young',\r\n\tBaby = 'Baby',\r\n}\r\n\r\nexport enum DogCoat {\r\n\tCurly = 'Curly',\r\n\tLong = 'Long',\r\n\tMedium = 'Medium',\r\n\tShort = 'Short',\r\n\tWire = 'Wire',\r\n\tHairless = 'Hairless',\r\n\tUnknown = 'Unknown',\r\n}\r\n\r\nexport enum DogGender {\r\n\tMale = 'Male',\r\n\tFemale = 'Female',\r\n\tUnknown = 'Unknown',\r\n}\r\nexport enum DogSize {\r\n\tSmall = 'Small',\r\n\tMedium = 'Medium',\r\n\tLarge = 'Large',\r\n\tExtraLarge = 'Extra Large',\r\n}\r\n\r\nexport const CoatYRange = [\r\n\tDogCoat.Curly,\r\n\tDogCoat.Long,\r\n\tDogCoat.Medium,\r\n\tDogCoat.Short,\r\n\tDogCoat.Wire,\r\n\tDogCoat.Hairless,\r\n\tDogCoat.Unknown,\r\n]\r\n\r\nexport const GenderYRange = [\r\n\tDogGender.Male,\r\n\tDogGender.Female,\r\n\tDogGender.Unknown,\r\n]\r\n\r\nexport const SizeYRange = [\r\n\tDogSize.Small,\r\n\tDogSize.Medium,\r\n\tDogSize.Large,\r\n\tDogSize.ExtraLarge,\r\n]\r\n// export interface DogDescriptionItem {\r\n// \tpetId: number\r\n// \tposted: Date\r\n// \tage: number\r\n// \tgender: DogGender\r\n// \tsize: DogSize\r\n// \tstate: string\r\n// \tcoat: DogCoat\r\n// \tname: string\r\n// \tadoptable: boolean\r\n// \timgSrc: string\r\n// }\r\nexport interface XYCoordinates {\r\n\tx: number\r\n\ty: number\r\n\tcolor: string\r\n\thex: number\r\n\tyFilter: FilterYOptions\r\n}\r\nexport interface DogDescriptionItem {\r\n\tpos: XYCoordinates[]\r\n\tid: string\r\n}\r\nexport interface ChartData {\r\n\tid: number\r\n\txValue: number\r\n\tyValue: string\r\n\tname: string\r\n}\r\n\r\nexport interface DogDetails {\r\n\tposted: string\r\n\tage: number\r\n\tgender: DogGender\r\n\tstate: string\r\n\timgSrc: string\r\n\tname: string\r\n}\r\n\r\nexport interface DogMap {\r\n\t[key: string]: DogDetails\r\n}\r\n","import { useState, useCallback } from 'react'\r\nimport { IDropdownOption } from '@fluentui/react'\r\nimport { FilterYOptions } from '../types/data'\r\n\r\nconst defaultYOption = FilterYOptions.coat\r\n\r\nexport function useStateSelection(): [\r\n\tFilterYOptions,\r\n\t(event: React.FormEvent<HTMLDivElement>, item?: IDropdownOption) => void,\r\n] {\r\n\tconst [YSelectedItem, setYSelectedItem] = useState<FilterYOptions>(\r\n\t\tdefaultYOption,\r\n\t)\r\n\tconst onYChange = useCallback(\r\n\t\t(event: React.FormEvent<HTMLDivElement>, item?: IDropdownOption): void => {\r\n\t\t\tif (item) {\r\n\t\t\t\tconst selection = item.key as FilterYOptions\r\n\t\t\t\tsetYSelectedItem(selection)\r\n\t\t\t}\r\n\t\t},\r\n\t\t[setYSelectedItem],\r\n\t)\r\n\treturn [YSelectedItem, onYChange]\r\n}\r\n","import React, { memo } from 'react'\r\nimport styled from 'styled-components'\r\nconst imageURL = process.env.PUBLIC_URL + '/dog.svg'\r\nexport const Logo: React.FC = memo(function Logo() {\r\n\treturn (\r\n\t\t<Container>\r\n\t\t\t<LogoText src={imageURL} alt=\"puppy\" />\r\n\t\t</Container>\r\n\t)\r\n})\r\n\r\nconst Container = styled.div`\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n`\r\n\r\nconst LogoText = styled.img`\r\n\tmargin: 0;\r\n\tmargin-top: 8px;\r\n\theight: 100px;\r\n`\r\n","import React, { memo } from 'react'\r\nimport styled from 'styled-components'\r\nimport { Logo } from './Logo'\r\n\r\nexport const Header: React.FC = memo(function Header() {\r\n\treturn (\r\n\t\t<HeaderStyles>\r\n\t\t\t<Logo />\r\n\t\t\t<HeaderText>\r\n\t\t\t\t<h1> ❤ All the Dogs </h1>\r\n\t\t\t\t<p>\r\n\t\t\t\t\tAll the posts on PetFinder on Sept 29th 2019 plotted based on\r\n\t\t\t\t\tapproximate age of the dog. Data gather by The Pudding for the essay:{' '}\r\n\t\t\t\t\t<a\r\n\t\t\t\t\t\trel=\"noopener noreferrer\"\r\n\t\t\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\t\t\thref=\"https://pudding.cool/2019/10/shelters\"\r\n\t\t\t\t\t\tstyle={{ color: '#F683BA' }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tFinding Forever Homes\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</p>\r\n\t\t\t</HeaderText>\r\n\t\t</HeaderStyles>\r\n\t)\r\n})\r\nconst HeaderStyles = styled.div`\r\n\tmargin-left: 100px;\r\n\tdisplay: flex;\r\n`\r\nconst HeaderText = styled.div`\r\n\tdisplay: block;\r\n`\r\n","import React, { memo } from 'react'\r\n\r\nexport const Footer: React.FC = memo(function Footer() {\r\n\treturn (\r\n\t\t<span>\r\n\t\t\tIcons made by{' '}\r\n\t\t\t<a href=\"https://www.flaticon.com/authors/eucalyp\" title=\"Eucalyp\">\r\n\t\t\t\tEucalyp\r\n\t\t\t</a>\r\n\t\t\tand\r\n\t\t\t<a href=\"https://www.flaticon.com/authors/freepik\" title=\"freepik\">\r\n\t\t\t\tFreepik\r\n\t\t\t</a>{' '}\r\n\t\t\tfrom{' '}\r\n\t\t\t<a href=\"https://www.flaticon.com/\" title=\"Flaticon\">\r\n\t\t\t\twww.flaticon.com\r\n\t\t\t</a>\r\n\t\t</span>\r\n\t)\r\n})\r\n","/**\r\n * Performs function debouncing for events\r\n * @param callback function for debouncing\r\n * @param delay number of milliseconds delay\r\n */\r\n\r\nexport function debounce(\r\n\tcallback: (...args: any[]) => any,\r\n\tdelay = 100,\r\n): (this: any, ...args: any[]) => any {\r\n\tlet timer: any\r\n\treturn function (this: any, ...args: any[]) {\r\n\t\tif (timer) {\r\n\t\t\tclearTimeout(timer)\r\n\t\t}\r\n\t\t// eslint-disable-next-line @typescript-eslint/no-this-alias\r\n\t\tconst that = this\r\n\t\ttimer = setTimeout(() => {\r\n\t\t\ttimer = null as any\r\n\t\t\t;(callback as any).call(that, ...args)\r\n\t\t}, delay)\r\n\t}\r\n}\r\n","import React, { memo } from 'react'\r\nimport { Dropdown, IDropdownStyles, IDropdownOption } from '@fluentui/react'\r\nimport { FilterOptions, FilterYOptions } from '../../../types/data'\r\nimport { debounce } from '../../../utils/debounce'\r\nimport styled from 'styled-components'\r\n\r\nconst dropdownStyles: Partial<IDropdownStyles> = {\r\n\tdropdown: { maxWidth: 150 },\r\n\troot: { display: 'inline-table' },\r\n\ttitle: { fontFamily: \"'Gaegu', cursive\", fontSize: 18 },\r\n\tlabel: { fontFamily: \"'Gaegu', cursive\" },\r\n\tdropdownOptionText: { fontFamily: \"'Gaegu', cursive\", fontSize: 18 },\r\n}\r\n\r\ninterface ControlledDropdownProps {\r\n\tselectedOption: FilterOptions | FilterYOptions\r\n\tonDropDrownChange: (\r\n\t\tevent: React.FormEvent<HTMLDivElement>,\r\n\t\titem?: IDropdownOption,\r\n\t) => void\r\n\toptions: IDropdownOption[]\r\n\tlabel?: string\r\n}\r\n\r\nexport const ControlledDropdown: React.FC<ControlledDropdownProps> = memo(\r\n\tfunction ControlledDropdown({\r\n\t\tselectedOption,\r\n\t\tonDropDrownChange,\r\n\t\toptions,\r\n\t\tlabel,\r\n\t}) {\r\n\t\treturn (\r\n\t\t\t<Spacer>\r\n\t\t\t\t<Dropdown\r\n\t\t\t\t\tlabel={label || ''}\r\n\t\t\t\t\tonChange={debounce(onDropDrownChange)}\r\n\t\t\t\t\tselectedKey={selectedOption}\r\n\t\t\t\t\toptions={options}\r\n\t\t\t\t\tstyles={dropdownStyles}\r\n\t\t\t\t/>\r\n\t\t\t</Spacer>\r\n\t\t)\r\n\t},\r\n)\r\n\r\nconst Spacer = styled.div`\r\n\tmargin-left: 10px;\r\n\tdisplay: inline-table;\r\n`\r\n","import React, { memo } from 'react'\r\nimport { Slider, ISliderStyles } from '@fluentui/react'\r\nimport { SliderSettings } from '../../../hooks/useSliderSettings'\r\nimport styled from 'styled-components'\r\n\r\ninterface ControlledSliderProps {\r\n\tsliderOnChange: (value: number) => void\r\n\tsliderValue: number\r\n\tsliderSettings: SliderSettings\r\n}\r\n\r\nconst sliderStyles: Partial<ISliderStyles> = {\r\n\tslideBox: { maxWidth: 300 },\r\n\troot: { display: 'inline-table', fontFamily: \"'Gaegu', cursive\" },\r\n\ttitleLabel: { fontFamily: \"'Gaegu', cursive\" },\r\n}\r\n\r\nexport const ControlledSlider: React.FC<ControlledSliderProps> = memo(\r\n\tfunction ControlledSlider({ sliderOnChange, sliderValue, sliderSettings }) {\r\n\t\treturn (\r\n\t\t\t<Spacer>\r\n\t\t\t\t<Slider\r\n\t\t\t\t\tlabel=\"Adjust node count\"\r\n\t\t\t\t\tmin={sliderSettings.min}\r\n\t\t\t\t\tmax={sliderSettings.max}\r\n\t\t\t\t\tstep={1000}\r\n\t\t\t\t\tshowValue={true}\r\n\t\t\t\t\tsnapToStep={true}\r\n\t\t\t\t\tvalue={sliderValue}\r\n\t\t\t\t\tonChange={sliderOnChange}\r\n\t\t\t\t\tstyles={sliderStyles}\r\n\t\t\t\t/>\r\n\t\t\t</Spacer>\r\n\t\t)\r\n\t},\r\n)\r\n\r\nconst Spacer = styled.div`\r\n\tmargin-left: 10px;\r\n\tdisplay: inline-table;\r\n`\r\n","import { IChoiceGroupOption } from '@fluentui/react'\r\n\r\nexport enum Renderers {\r\n\tSVG = 'SVG',\r\n\tCanvas = 'Canvas',\r\n\tWebGL = 'WebGL',\r\n}\r\n\r\nconst imageSize = { width: 32, height: 32 }\r\nconst imageSrc = `${process.env.PUBLIC_URL}/cocker-sp-outline.svg`\r\nconst selectedImageSrc = `${process.env.PUBLIC_URL}/cocker-sp.svg`\r\n\r\nexport const RendererOptions: IChoiceGroupOption[] = [\r\n\t{\r\n\t\tkey: Renderers.SVG,\r\n\t\ttext: Renderers.SVG,\r\n\t\timageSrc,\r\n\t\tselectedImageSrc,\r\n\t\timageSize,\r\n\t},\r\n\t{\r\n\t\tkey: Renderers.Canvas,\r\n\t\ttext: Renderers.Canvas,\r\n\t\timageSrc,\r\n\t\tselectedImageSrc,\r\n\t\timageSize,\r\n\t},\r\n\t{\r\n\t\tkey: Renderers.WebGL,\r\n\t\ttext: Renderers.WebGL,\r\n\t\timageSrc,\r\n\t\tselectedImageSrc,\r\n\t\timageSize,\r\n\t},\r\n]\r\n","import * as React from 'react'\r\nimport { memo, FormEvent } from 'react'\r\nimport { IChoiceGroupOption, ChoiceGroup } from '@fluentui/react'\r\nimport styled from 'styled-components'\r\nimport { RendererOptions } from './constants'\r\n\r\ninterface RendererControlsProps {\r\n\tselectedRender: string\r\n\tonChange: (\r\n\t\tev: FormEvent<HTMLElement | HTMLInputElement> | undefined,\r\n\t\toption?: IChoiceGroupOption,\r\n\t) => void\r\n}\r\nexport const RendererControls: React.FC<RendererControlsProps> = memo(\r\n\tfunction RendererControls({ selectedRender, onChange }) {\r\n\t\treturn (\r\n\t\t\t<Spacer>\r\n\t\t\t\t<ChoiceGroup\r\n\t\t\t\t\tselectedKey={selectedRender}\r\n\t\t\t\t\toptions={RendererOptions}\r\n\t\t\t\t\tonChange={onChange}\r\n\t\t\t\t\tlabel=\"Renderer\"\r\n\t\t\t\t/>\r\n\t\t\t</Spacer>\r\n\t\t)\r\n\t},\r\n)\r\n\r\nconst Spacer = styled.div`\r\n\tmargin-left: 10px;\r\n\tdisplay: inline-table;\r\n`\r\n","import React, { memo } from 'react'\r\nimport styled from 'styled-components'\r\nimport { ControlledDropdown } from './ControlledDropdown'\r\nimport { ControlledSlider } from './ControlledSlider/ControlledSlider'\r\nimport { FilterYOptions, DropdownYOptions } from '../../types/data'\r\nimport { IDropdownOption, IChoiceGroupOption } from '@fluentui/react'\r\nimport { SliderSettings } from '../../hooks/useSliderSettings'\r\nimport { RendererControls } from './RendererControls'\r\n\r\ninterface ControlsProps {\r\n\tyAxisFilter: FilterYOptions\r\n\r\n\tonYDropDrownChange: (\r\n\t\tevent: React.FormEvent<HTMLDivElement>,\r\n\t\titem?: IDropdownOption,\r\n\t) => void\r\n\tonSliderChange: (value: number) => void\r\n\tsliderSettings: SliderSettings\r\n\tselectedMax: number\r\n\r\n\tselectedRender: string\r\n\tonRendererChange: (\r\n\t\tev: React.FormEvent<HTMLElement | HTMLInputElement> | undefined,\r\n\t\toption?: IChoiceGroupOption,\r\n\t) => void\r\n}\r\n\r\nexport const Controls: React.FC<ControlsProps> = memo(function Controls({\r\n\tyAxisFilter,\r\n\tonYDropDrownChange,\r\n\tonSliderChange,\r\n\tsliderSettings,\r\n\tselectedMax,\r\n\tselectedRender,\r\n\tonRendererChange,\r\n}) {\r\n\treturn (\r\n\t\t<ControlStyles>\r\n\t\t\t<ControlledDropdown\r\n\t\t\t\tselectedOption={yAxisFilter}\r\n\t\t\t\tonDropDrownChange={onYDropDrownChange}\r\n\t\t\t\toptions={DropdownYOptions}\r\n\t\t\t\tlabel={'group dogs by:'}\r\n\t\t\t/>\r\n\t\t\t<ControlledSlider\r\n\t\t\t\tsliderOnChange={onSliderChange}\r\n\t\t\t\tsliderSettings={sliderSettings}\r\n\t\t\t\tsliderValue={selectedMax}\r\n\t\t\t/>\r\n\t\t\t<RendererControls\r\n\t\t\t\tselectedRender={selectedRender}\r\n\t\t\t\tonChange={onRendererChange}\r\n\t\t\t/>\r\n\t\t</ControlStyles>\r\n\t)\r\n})\r\n\r\nconst ControlStyles = styled.div`\r\n\tdisplay: 'inline-flex';\r\n\tmargin-left: 100px;\r\n`\r\n","import React, {\r\n\tmemo,\r\n\tuseEffect,\r\n\tuseRef,\r\n\tMutableRefObject,\r\n\tuseMemo,\r\n} from 'react'\r\nimport { useDimensions } from './useDimensions'\r\nimport { SizedToParentProps } from './types'\r\n\r\nconst DEFAULT_STYLE = {\r\n\t/* position: absolute so we don't cause the parent element to continually expand */\r\n\tposition: 'absolute',\r\n\tleft: 0,\r\n\tright: 0,\r\n\ttop: 0,\r\n\tbottom: 0,\r\n\toverflow: 'hidden',\r\n} as React.CSSProperties\r\n\r\n/**\r\n * Provides an element that is sized to its parent, without affecting the size of the parent.\r\n * It works by creating an element that is out of the layout flow (using position: absolute).\r\n *\r\n * Children should be styled with 'width: 100%, height: 100%' or use the onResize event listener to control the size of children or some other combination\r\n */\r\nexport const SizedToParent: React.FC<SizedToParentProps> = memo(\r\n\t({ sizedRef, onResize, children, className, style }: SizedToParentProps) => {\r\n\t\tconst defaultRef = useRef(null)\r\n\t\tconst ref: MutableRefObject<HTMLElement | null> = useMemo(\r\n\t\t\t() => sizedRef || defaultRef,\r\n\t\t\t[defaultRef, sizedRef],\r\n\t\t)\r\n\t\tconst dims = useDimensions(ref)\r\n\t\tuseEffect(() => {\r\n\t\t\tif (ref && dims && onResize) {\r\n\t\t\t\tonResize(dims)\r\n\t\t\t}\r\n\t\t}, [ref, dims, onResize])\r\n\t\tconst finalStyle = useMemo(\r\n\t\t\t() => ({\r\n\t\t\t\t...DEFAULT_STYLE,\r\n\t\t\t\t...(style || {}),\r\n\t\t\t}),\r\n\t\t\t[style],\r\n\t\t)\r\n\r\n\t\treturn (\r\n\t\t\t<div className={className} ref={ref as any} style={finalStyle}>\r\n\t\t\t\t{children}\r\n\t\t\t</div>\r\n\t\t)\r\n\t},\r\n)\r\nSizedToParent.displayName = 'SizedToParent'\r\n","import { useState, MutableRefObject, useEffect } from 'react'\r\nimport ResizeObserver from 'resize-observer-polyfill'\r\nimport { Dimensions } from './types'\r\n\r\n/**\r\n * A hook for getting the dimensions of the given element\r\n * This hook also updates when the given element resizes\r\n * @param ref A ref to the element to measure\r\n * @returns The dimensions for the element.\r\n */\r\nexport function useDimensions(\r\n\tref: MutableRefObject<HTMLElement | null>,\r\n): Dimensions | undefined {\r\n\tconst [dimensions, setDimensions] = useState<Dimensions | undefined>()\r\n\tuseEffect(() => {\r\n\t\tif (ref && ref.current) {\r\n\t\t\tconst rect = ref.current.getBoundingClientRect()\r\n\t\t\tlet dims: Dimensions = {\r\n\t\t\t\twidth: Math.floor(rect.width),\r\n\t\t\t\theight: Math.floor(rect.height),\r\n\t\t\t}\r\n\t\t\tsetDimensions(dims)\r\n\r\n\t\t\tconst observer = new ResizeObserver(entries => {\r\n\t\t\t\tconst entry = entries[0]\r\n\t\t\t\tif (entry) {\r\n\t\t\t\t\tconst newDims = {\r\n\t\t\t\t\t\twidth: Math.floor(entry.contentRect.width),\r\n\t\t\t\t\t\theight: Math.floor(entry.contentRect.height),\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (newDims.width !== dims.width || newDims.height !== dims.height) {\r\n\t\t\t\t\t\tdims = newDims\r\n\t\t\t\t\t\tsetDimensions(newDims)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tobserver.observe(ref.current)\r\n\t\t\treturn () => {\r\n\t\t\t\tobserver.disconnect()\r\n\t\t\t}\r\n\t\t}\r\n\t}, [ref])\r\n\treturn dimensions as Dimensions | undefined\r\n}\r\n","export const correctedMargins = {\r\n\tleft: 100,\r\n\tright: 100,\r\n\ttop: 10,\r\n\tbottom: 40,\r\n}\r\n","import { useState, useCallback } from 'react'\r\n\r\n/**\r\n * Use a callback-based element reference. This is useful when the\r\n * element is required for in-band rendering or effectful measuring.\r\n *\r\n */\r\nexport function useCallbackRef<T>(): [(ref: T) => void, T | null] {\r\n\tconst [element, setElement] = useState<T | null>(null)\r\n\tconst refCb = useCallback((node: T) => setElement(node), [setElement])\r\n\treturn [refCb, element]\r\n}\r\n","import { DogDetails } from '../types/data'\r\n\r\nexport function getTooltipHtml(data: DogDetails): string {\r\n\treturn `\r\n\t<h2>${data.name.toUpperCase()}</h2>\r\n\t<img src=${process.env.PUBLIC_URL + data.imgSrc} style=\"width: 100px;\"> </img>\r\n\tAge: ${Math.round(data.age)}<br />Posted: ${new Date(\r\n\t\tdata.posted,\r\n\t).toDateString()}\r\n\t<br /> State: ${data.state}\r\n\t`\r\n}\r\n","import { useCallback } from 'react'\r\nimport { useTooltipPositioner } from './useTooltipPositioner'\r\nimport { DogMap } from '../../../../types/data'\r\nimport { getTooltipHtml } from '../../../../utils'\r\n\r\nexport function useHoverEvents(\r\n\ttooltip?: HTMLDivElement | null,\r\n\tdetails?: DogMap,\r\n): [\r\n\t// onMouseEnter\r\n\t(d: string, coords: [number, number]) => void,\r\n\t// onMouseLeave\r\n\t() => void,\r\n] {\r\n\tconst showToolTip = useTooltipPositioner(tooltip)\r\n\r\n\tconst onMouseEnter = useCallback(\r\n\t\t(id: string, coords: [number, number]) => {\r\n\t\t\tif (tooltip) {\r\n\t\t\t\tconst innerHTML =\r\n\t\t\t\t\tdetails && details[id] ? getTooltipHtml(details[id]) : ''\r\n\t\t\t\ttooltip.style.padding = `2px`\r\n\t\t\t\ttooltip.innerHTML = innerHTML\r\n\t\t\t\ttooltip.style.backgroundColor = '#f1f1f1'\r\n\t\t\t\ttooltip.style.border = `1px solid #767676`\r\n\t\t\t\ttooltip.style.color = 'black'\r\n\t\t\t\ttooltip.style.fontSize = '14px'\r\n\t\t\t\ttooltip.style.fontSize = '14px'\r\n\t\t\t\ttooltip.style.visibility = 'visible'\r\n\t\t\t\tshowToolTip(coords)\r\n\t\t\t}\r\n\t\t},\r\n\t\t[tooltip, showToolTip, details],\r\n\t)\r\n\tconst onMouseLeave = useCallback(() => {\r\n\t\tif (tooltip) {\r\n\t\t\ttooltip.style.visibility = 'hidden'\r\n\t\t}\r\n\t}, [tooltip])\r\n\r\n\treturn [onMouseEnter, onMouseLeave]\r\n}\r\n","import { useCallback } from 'react'\r\n\r\n// updates the position of the tooltip and change visibility\r\nexport function useTooltipPositioner(\r\n\telement?: HTMLDivElement | null,\r\n): (pos: [number, number]) => void {\r\n\treturn useCallback(\r\n\t\t(postion: [number, number]) => {\r\n\t\t\tif (postion && element) {\r\n\t\t\t\tconst xPos = postion[0]\r\n\t\t\t\tconst yPos = postion[1]\r\n\t\t\t\tif (element) {\r\n\t\t\t\t\telement.style.left = `${xPos + 150}px`\r\n\t\t\t\t\telement.style.top = `${yPos - 10}px`\r\n\t\t\t\t\telement.style.visibility = 'visible'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t[element],\r\n\t)\r\n}\r\n","import { useLayoutEffect } from 'react'\r\nimport { useSelectionOnNode } from '../../hooks/useSelectionOnNode'\r\nimport { Selection, select } from 'd3-selection'\r\nimport { transition } from 'd3-transition'\r\nimport { useHoverEvents } from './events'\r\nimport { DogMap } from '../../../../types/data'\r\nimport { Data } from '../../types'\r\n\r\nconst t: any = transition().duration(1000)\r\nconst defaultRadius = 2\r\n\r\ninterface DrawCircles {\r\n\telement: SVGGElement | null\r\n\tdata: Data[]\r\n\tshowData: boolean\r\n\ttooltip?: HTMLDivElement | null\r\n\tdetails?: DogMap\r\n}\r\nexport function useCircleDrawing({\r\n\telement,\r\n\tdata,\r\n\tshowData,\r\n\ttooltip,\r\n\tdetails,\r\n}: DrawCircles) {\r\n\tconst elementSelection = useSelectionOnNode<SVGGElement>(element)\r\n\r\n\tconst [onCircleMouseover, onCircleMouseout] = useHoverEvents(tooltip, details)\r\n\r\n\tuseLayoutEffect(() => {\r\n\t\tif (elementSelection !== null && data.length > 0 && showData) {\r\n\t\t\telementSelection\r\n\t\t\t\t.selectAll('.dog-nodes')\r\n\t\t\t\t.data(data, (d: Data) => d.id)\r\n\t\t\t\t.join(\r\n\t\t\t\t\t(enter: Selection<any, any, any, any>) =>\r\n\t\t\t\t\t\tenter\r\n\t\t\t\t\t\t\t.append('circle')\r\n\t\t\t\t\t\t\t.attr('class', 'dog-nodes')\r\n\t\t\t\t\t\t\t.attr('cx', (d: Data) => d.x)\r\n\t\t\t\t\t\t\t.attr('cy', 0)\r\n\t\t\t\t\t\t\t.attr('r', defaultRadius)\r\n\t\t\t\t\t\t\t.attr('aria-label', (d: Data) => `${d.yFilter}-${d.x}`)\r\n\t\t\t\t\t\t\t.call((e: any) =>\r\n\t\t\t\t\t\t\t\te\r\n\t\t\t\t\t\t\t\t\t.interrupt()\r\n\t\t\t\t\t\t\t\t\t.transition(t as any)\r\n\t\t\t\t\t\t\t\t\t.attr('cy', (d: Data) => d.y),\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t.style('fill', (d: Data) => d.color)\r\n\t\t\t\t\t\t\t.style('opacity', 0.8)\r\n\t\t\t\t\t\t\t.style('stroke-width', 1)\r\n\t\t\t\t\t\t\t.style('stroke', (d: Data) => d.color)\r\n\t\t\t\t\t\t\t.attr('stroke-opacity', 1),\r\n\r\n\t\t\t\t\t(update: Selection<any, any, any, any>) =>\r\n\t\t\t\t\t\tupdate.call((e: any) =>\r\n\t\t\t\t\t\t\te\r\n\t\t\t\t\t\t\t\t.interrupt()\r\n\t\t\t\t\t\t\t\t.transition(t as any)\r\n\t\t\t\t\t\t\t\t.style('fill', (d: Data) => d.color)\r\n\t\t\t\t\t\t\t\t.attr('cx', (d: Data) => d.x)\r\n\t\t\t\t\t\t\t\t.attr('cy', (d: Data) => d.y)\r\n\t\t\t\t\t\t\t\t.style('stroke-width', 1)\r\n\t\t\t\t\t\t\t\t.style('stroke', (d: Data) => d.color)\r\n\t\t\t\t\t\t\t\t.style('stroke-opacity', 1),\r\n\t\t\t\t\t\t),\r\n\r\n\t\t\t\t\t(exit: Selection<any, any, any, any>) =>\r\n\t\t\t\t\t\texit.call((e: any) => e.remove()),\r\n\t\t\t\t)\r\n\t\t\t\t.on('mouseover', function (d: Data) {\r\n\t\t\t\t\t// @ts-ignore\r\n\t\t\t\t\tselect(this).attr('r', defaultRadius * 2)\r\n\t\t\t\t\t// show tooltip\r\n\t\t\t\t\tonCircleMouseover(d.id, [d.x, d.y])\r\n\t\t\t\t})\r\n\t\t\t\t.on('mouseout', function (d: Data) {\r\n\t\t\t\t\t// @ts-ignore\r\n\t\t\t\t\tselect(this).attr('r', defaultRadius)\r\n\t\t\t\t\tonCircleMouseout()\r\n\t\t\t\t})\r\n\t\t}\r\n\t}, [\r\n\t\telementSelection,\r\n\t\tdata,\r\n\t\ttooltip,\r\n\t\tonCircleMouseout,\r\n\t\tonCircleMouseover,\r\n\t\tdetails,\r\n\t\tshowData,\r\n\t])\r\n}\r\n","import { useMemo } from 'react'\r\nimport { select, BaseType, Selection } from 'd3-selection'\r\n\r\n/**\r\n * Creates a d3 selection over a node.\r\n * @HACK - the any return type prevents d3 typings issues, but shoul be resolved eventually\r\n * @param element The element to create the d3 selection over\r\n */\r\nexport function useSelectionOnNode<EType extends BaseType, Datum = unknown>(\r\n\telement: EType | null,\r\n): Selection<EType, Datum, null, undefined> | null | any {\r\n\treturn useMemo(() => (element ? select(element) : null), [element])\r\n}\r\n","import React, { memo } from 'react'\r\nimport { useCallbackRef } from '../hooks/useCallbackRef'\r\nimport { correctedMargins } from '../constants'\r\nimport { useResizeHandling } from '../hooks/useResizeHandling'\r\nimport { DogMap } from '../../../types/data'\r\nimport { useCircleDrawing } from './hooks/draw'\r\nimport { useXAxisTheming, useYAxisTheming } from '../hooks/axis'\r\nimport { ScaleBand, ScaleLinear } from 'd3-scale'\r\nimport { Data } from '../types'\r\n\r\nexport interface BeeSwarmContainerProps {\r\n\tdata: Data[]\r\n\twidth: number\r\n\theight: number\r\n\tvpHeight: number\r\n\tvpWidth: number\r\n\ttooltip?: HTMLDivElement | null\r\n\tyScale: ScaleBand<string>\r\n\txScale: ScaleLinear<number, number>\r\n\tshowData: boolean\r\n\tdetails?: DogMap\r\n}\r\n\r\nexport const BeeSwarmContainer: React.FC<BeeSwarmContainerProps> = memo(\r\n\tfunction BeeSwarmContainer({\r\n\t\tdata,\r\n\t\twidth,\r\n\t\theight,\r\n\t\ttooltip,\r\n\t\tvpHeight,\r\n\t\tvpWidth,\r\n\t\tyScale,\r\n\t\txScale,\r\n\t\tshowData,\r\n\t\tdetails,\r\n\t}: BeeSwarmContainerProps) {\r\n\t\t// Get Refs for SVG Elements\r\n\t\tconst [setSvgEl, svgElementRef] = useCallbackRef<SVGSVGElement>()\r\n\t\tconst [setXAxisElement, xAxisElement] = useCallbackRef<SVGGElement>()\r\n\t\tconst [setYAxisElement, yAxisElement] = useCallbackRef<SVGGElement>()\r\n\t\tconst [\r\n\t\t\tsetBeeSwarmContainerElement,\r\n\t\t\tBeeSwarmContainerElement,\r\n\t\t] = useCallbackRef<SVGGElement>()\r\n\r\n\t\t// Optional: Apply thematic D3 themes\r\n\t\tuseResizeHandling(svgElementRef, width, height)\r\n\r\n\t\t// Append Axis\r\n\t\tuseXAxisTheming(xAxisElement, vpHeight, xScale)\r\n\t\tuseYAxisTheming(yAxisElement, yScale)\r\n\r\n\t\tuseCircleDrawing({\r\n\t\t\telement: BeeSwarmContainerElement,\r\n\t\t\tdata,\r\n\t\t\ttooltip,\r\n\t\t\tdetails,\r\n\t\t\tshowData,\r\n\t\t})\r\n\r\n\t\treturn (\r\n\t\t\t<div style={{ position: 'absolute', zIndex: 1 }}>\r\n\t\t\t\t<svg ref={setSvgEl} width={width} height={height} role=\"img\">\r\n\t\t\t\t\t<title> Dog Posts on Petfinder API</title>\r\n\t\t\t\t\t<desc id=\"desc\">\r\n\t\t\t\t\t\t{' '}\r\n\t\t\t\t\t\tShow increasing number of dog post based on user selection on one\r\n\t\t\t\t\t\tgiven day\r\n\t\t\t\t\t</desc>\r\n\t\t\t\t\t<g\r\n\t\t\t\t\t\tclassName=\"viewport\"\r\n\t\t\t\t\t\ttransform={`translate(${correctedMargins.left},${correctedMargins.top})`}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<g className=\"yscale\" ref={setYAxisElement} aria-label=\"yscale\"></g>\r\n\t\t\t\t\t\t<g className=\"xscale\" ref={setXAxisElement} aria-label=\"xscale\"></g>\r\n\t\t\t\t\t\t<g\r\n\t\t\t\t\t\t\tclassName=\"plotarea\"\r\n\t\t\t\t\t\t\twidth={vpWidth}\r\n\t\t\t\t\t\t\theight={vpHeight}\r\n\t\t\t\t\t\t\taria-label=\"plotarea\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<g ref={setBeeSwarmContainerElement} className=\"beeswarm\"></g>\r\n\t\t\t\t\t\t</g>\r\n\t\t\t\t\t</g>\r\n\t\t\t\t</svg>\r\n\t\t\t</div>\r\n\t\t)\r\n\t},\r\n)\r\n","import { useEffect } from 'react'\r\nimport { select } from 'd3-selection'\r\n\r\nexport function useResizeHandling(\r\n\telement: SVGSVGElement | null,\r\n\twidth: number,\r\n\theight: number,\r\n): void {\r\n\tuseEffect(() => {\r\n\t\tif (element) {\r\n\t\t\tselect(element).attr('width', width).attr('height', height)\r\n\t\t}\r\n\t}, [element, width, height])\r\n}\r\n","import { useEffect } from 'react'\r\nimport { select } from 'd3-selection'\r\nimport { axisBottom, axisLeft } from 'd3-axis'\r\nimport { ScaleLinear, ScaleBand, ScaleTime } from 'd3-scale'\r\nexport function useXAxisTheming(\r\n\telement: SVGGElement | null,\r\n\theight: number,\r\n\txScale: ScaleLinear<number, number> | ScaleTime<number, number>,\r\n): void {\r\n\tuseEffect(() => {\r\n\t\tif (element && element !== null) {\r\n\t\t\tselect(element)\r\n\t\t\t\t.call(axisBottom(xScale))\r\n\t\t\t\t.attr('transform', `translate(0, ${height})`)\r\n\t\t\t\t.selectAll('text')\r\n\t\t\t\t.style('font-family', \"'Gaegu', cursive\")\r\n\t\t\t\t.style('font-size', '20px')\r\n\t\t}\r\n\t}, [element, height, xScale])\r\n}\r\n\r\nexport function useYAxisTheming(\r\n\telement: SVGGElement | null,\r\n\tyScale: ScaleBand<string>,\r\n): void {\r\n\tuseEffect(() => {\r\n\t\tif (element && element !== null) {\r\n\t\t\tselect(element)\r\n\t\t\t\t.call(axisLeft(yScale))\r\n\t\t\t\t.selectAll('text')\r\n\t\t\t\t.style('font-family', \"'Gaegu', cursive\")\r\n\t\t\t\t.style('font-size', '20px')\r\n\t\t}\r\n\t}, [element, yScale])\r\n}\r\n","import React, { memo } from 'react'\r\nimport { DogMap } from '../../../types/data'\r\nimport { BeeSwarmContainer } from './BeeSwarmSVG'\r\nimport styled from 'styled-components'\r\nimport { ScaleBand, ScaleLinear } from 'd3-scale'\r\nimport { useCallbackRef } from '../hooks/useCallbackRef'\r\nimport { Data } from '../types'\r\n\r\nexport interface SVGContainerProps {\r\n\tdata: Data[]\r\n\twidth: number\r\n\theight: number\r\n\tvpHeight: number\r\n\tvpWidth: number\r\n\tyScale: ScaleBand<string>\r\n\txScale: ScaleLinear<number, number>\r\n\tdetails?: DogMap\r\n}\r\n\r\nexport const SVGBeeSwarm: React.FC<SVGContainerProps> = memo(\r\n\tfunction SVGBeeSwarm({\r\n\t\tdata,\r\n\t\twidth,\r\n\t\theight,\r\n\t\tvpHeight,\r\n\t\tvpWidth,\r\n\t\tyScale,\r\n\t\txScale,\r\n\t\tdetails,\r\n\t}: SVGContainerProps) {\r\n\t\tconst [setTooltip, tooltip] = useCallbackRef<HTMLDivElement | null>()\r\n\t\treturn (\r\n\t\t\t<ChartStyle>\r\n\t\t\t\t<BeeSwarmContainer\r\n\t\t\t\t\twidth={width}\r\n\t\t\t\t\theight={height}\r\n\t\t\t\t\tvpHeight={vpHeight}\r\n\t\t\t\t\tvpWidth={vpWidth}\r\n\t\t\t\t\tdata={data}\r\n\t\t\t\t\ttooltip={tooltip}\r\n\t\t\t\t\tyScale={yScale}\r\n\t\t\t\t\txScale={xScale}\r\n\t\t\t\t\tdetails={details}\r\n\t\t\t\t\tshowData={true}\r\n\t\t\t\t/>\r\n\t\t\t\t<ToolTip ref={setTooltip} className=\"tooltip-svg-ref\" />\r\n\t\t\t</ChartStyle>\r\n\t\t)\r\n\t},\r\n)\r\n\r\nconst ChartStyle = styled.div`\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\tposition: relative;\r\n`\r\n\r\nconst ToolTip = styled.div`\r\n\tz-index: 3;\r\n\tposition: absolute;\r\n\tvisibility: hidden;\r\n`\r\n","import { ScaleBand } from 'd3-scale'\r\nimport { useMemo } from 'react'\r\nimport { FilterYOptions, DogDescriptionItem } from '../../../types/data'\r\nimport { Data } from '../types'\r\nconst radius = 2\r\ninterface TransformedDataProps {\r\n\tvpWidth: number\r\n\tvpHeight: number\r\n\tdata: DogDescriptionItem[]\r\n\tyAxisFilter: FilterYOptions\r\n\tyScale: ScaleBand<string>\r\n\tselectedMax: number\r\n}\r\nexport function useTransformedData({\r\n\tdata,\r\n\tyScale,\r\n\tvpHeight,\r\n\tvpWidth,\r\n\tyAxisFilter,\r\n\tselectedMax,\r\n}: TransformedDataProps): Data[] {\r\n\tconst mappedData = useMemo((): Data[] => {\r\n\t\treturn data.reduce((acc, d) => {\r\n\t\t\tconst coords = d.pos\r\n\t\t\tconst found = coords.find(o => o.yFilter === yAxisFilter)\r\n\t\t\tif (found) {\r\n\t\t\t\tconst y = found.y * vpHeight + yScale.bandwidth() / 2\r\n\t\t\t\tconst x = found.x * vpWidth\r\n\t\t\t\tacc.push(\r\n\t\t\t\t\tObject.assign(\r\n\t\t\t\t\t\t{},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tx,\r\n\t\t\t\t\t\t\ty,\r\n\t\t\t\t\t\t\tcolor: found.color,\r\n\t\t\t\t\t\t\thex: found.hex,\r\n\t\t\t\t\t\t\tid: d.id,\r\n\t\t\t\t\t\t\tyFilter: found.yFilter,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t),\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\treturn acc\r\n\t\t}, [] as Data[])\r\n\t}, [vpWidth, vpHeight, data, yAxisFilter, yScale])\r\n\tconst heightData = useMemo((): Data[] => {\r\n\t\treturn mapHeight(mappedData, radius, yScale.bandwidth())\r\n\t}, [mappedData, yScale])\r\n\treturn useMemo(() => heightData.slice(0, selectedMax), [\r\n\t\theightData,\r\n\t\tselectedMax,\r\n\t])\r\n}\r\n\r\ninterface HMap {\r\n\t[key: number]: Data[]\r\n}\r\n\r\nfunction mapHeight(data: Data[], radius: number, maxBandwidth: number) {\r\n\tconst hMap: HMap = {}\r\n\tlet rFactor = 0\r\n\tconst xOffset = radius * 2\r\n\tlet yHeight = 0\r\n\tlet positive = true\r\n\r\n\tfor (const d of data) {\r\n\t\trFactor = Math.floor(d.x / xOffset)\r\n\t\tif (!hMap[rFactor]) {\r\n\t\t\thMap[rFactor] = []\r\n\t\t}\r\n\t\thMap[rFactor].push(d)\r\n\t}\r\n\tconst output: any[] = []\r\n\tfor (const k in hMap) {\r\n\t\tconst arr = hMap[k]\r\n\t\tyHeight = 0\r\n\t\tlet yHeightDown = 0\r\n\t\tlet maxX = 0\r\n\t\tpositive = true\r\n\t\tfor (const node of arr) {\r\n\t\t\tmaxX = Math.max(maxX, node.x)\r\n\t\t\tif (positive) {\r\n\t\t\t\tyHeight += yHeight === 0 ? 0 : radius\r\n\t\t\t\tyHeight = Math.min(yHeight, maxBandwidth / 2)\r\n\t\t\t\tnode.y = node.y - yHeight\r\n\t\t\t\tyHeight += radius\r\n\t\t\t\tyHeightDown = yHeightDown === 0 ? radius : yHeightDown\r\n\t\t\t\tpositive = false\r\n\t\t\t} else {\r\n\t\t\t\tyHeightDown += radius\r\n\t\t\t\tyHeightDown = Math.min(yHeightDown, maxBandwidth / 2)\r\n\t\t\t\tnode.y = node.y + yHeightDown\r\n\t\t\t\tyHeightDown += radius\r\n\t\t\t\tpositive = true\r\n\t\t\t}\r\n\t\t\toutput.push(node)\r\n\t\t}\r\n\t}\r\n\treturn output\r\n}\r\n","import { DogMap } from '../../../../types/data'\r\nimport { getTooltipHtml } from '../../../../utils'\r\n\r\nclass TooltipManager {\r\n\tprivate toolTipElement: HTMLDivElement | null\r\n\tprivate dogMap: DogMap = {}\r\n\r\n\tconstructor(toolTipElement: HTMLDivElement | null) {\r\n\t\tthis.toolTipElement = toolTipElement\r\n\t}\r\n\r\n\tpublic setTooltipElement(element: HTMLDivElement | null) {\r\n\t\tthis.toolTipElement = element\r\n\t}\r\n\r\n\tpublic setDogMap(dogMap?: DogMap) {\r\n\t\tif (dogMap) {\r\n\t\t\tthis.dogMap = dogMap\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateTooltipPositioner(postion: [number, number]) {\r\n\t\tconst element = this.toolTipElement\r\n\t\tif (postion && element) {\r\n\t\t\tconst xPos = postion[0]\r\n\t\t\tconst yPos = postion[1]\r\n\t\t\tif (element) {\r\n\t\t\t\telement.style.left = `${xPos + 150}px`\r\n\t\t\t\telement.style.top = `${yPos - 10}px`\r\n\t\t\t\telement.style.visibility = 'visible'\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic showToolTip(id: string, coords: [number, number]) {\r\n\t\tconst tooltip = this.toolTipElement\r\n\t\tif (tooltip) {\r\n\t\t\tconst innerHTML = this.dogMap[id] ? getTooltipHtml(this.dogMap[id]) : ''\r\n\t\t\ttooltip.style.padding = `2px`\r\n\t\t\ttooltip.innerHTML = innerHTML\r\n\t\t\ttooltip.style.backgroundColor = '#f1f1f1'\r\n\t\t\ttooltip.style.border = `1px solid #767676`\r\n\t\t\ttooltip.style.color = 'black'\r\n\t\t\ttooltip.style.fontSize = '14px'\r\n\t\t\ttooltip.style.visibility = 'visible'\r\n\t\t\tthis.updateTooltipPositioner(coords)\r\n\t\t}\r\n\t}\r\n\r\n\tpublic hideTooltip() {\r\n\t\tconst tooltip = this.toolTipElement\r\n\t\tif (tooltip) {\r\n\t\t\ttooltip.style.visibility = 'hidden'\r\n\t\t}\r\n\t}\r\n}\r\nexport default TooltipManager\r\n","import { SpriteMap, SpriteInternalCoords, Data } from '../types'\r\nimport * as PIXI from 'pixi.js'\r\nimport { Dimensions } from '../../../utils/types'\r\nimport { easeCubic } from 'd3-ease'\r\nimport { correctedMargins } from '../constants'\r\nimport TooltipManager from './utils/TooltipManager'\r\nimport { DogMap } from '../../../types/data'\r\nimport { Renderers } from '../../Controls/RendererControls/constants'\r\n// If you want to use canvas 2d with Pixi:\r\n// @ts-ignore\r\nexport * from 'pixi.js-legacy'\r\n// @ts-ignore\r\nexport * from '@pixi/canvas-renderer'\r\n\r\nconst duration = 1000\r\nconst radius = 2\r\n\r\nclass PixiRenderer {\r\n\tprivate pixiElement: HTMLDivElement\r\n\tprivate renderer: PIXI.Renderer | PIXI.CanvasRenderer | null\r\n\tprivate circleTexture: PIXI.Texture\r\n\tprivate nodesStage: PIXI.Container\r\n\tprivate stage: PIXI.Container\r\n\tprivate dimensions: Dimensions\r\n\tprivate spriteKeys: Set<string> = new Set([])\r\n\tprivate tweenedScale = 1\r\n\tprivate ToolTipManagerInstance?: TooltipManager //handles visibility of tooltip\r\n\tprivate rendererType: Renderers\r\n\tprivate spriteMap: SpriteMap = {}\r\n\r\n\tconstructor(\r\n\t\tcontainerEl: HTMLDivElement,\r\n\t\ttoolTipElement: HTMLDivElement | null,\r\n\t\tdimensions: Dimensions,\r\n\t\trenderer: Renderers,\r\n\t) {\r\n\t\tthis.dimensions = dimensions\r\n\t\tthis.pixiElement = containerEl\r\n\t\tthis.ToolTipManagerInstance = new TooltipManager(toolTipElement)\r\n\t\tthis.rendererType = renderer\r\n\t\t// === set up pixi stuff ===\r\n\t\tthis.renderer = this.setRenderer(renderer, dimensions)\r\n\t\tconst circleTemplate = new PIXI.Graphics()\r\n\t\t\t.beginFill(0xffffff)\r\n\t\t\t.lineStyle(0)\r\n\t\t\t.drawCircle(0, 0, 100)\r\n\t\t\t.endFill()\r\n\t\tthis.circleTexture = this.renderer.generateTexture(\r\n\t\t\tcircleTemplate,\r\n\t\t\tPIXI.SCALE_MODES.NEAREST,\r\n\t\t\tdimensions.width / dimensions.height,\r\n\t\t)\r\n\t\t// canvas element to draw to\r\n\t\tthis.pixiElement.appendChild(this.renderer.view)\r\n\t\tthis.nodesStage = new PIXI.Container()\r\n\r\n\t\t// stage is container for our sprite elements\r\n\t\tthis.stage = new PIXI.Container()\r\n\t\tthis.stage.addChild(this.nodesStage)\r\n\t\t// adjust for the margins\r\n\t\tthis.stage.transform.position.y = correctedMargins.top\r\n\t\tthis.stage.transform.position.x = correctedMargins.left\r\n\t}\r\n\r\n\tprivate setRenderer(renderer: Renderers, dimensions: Dimensions) {\r\n\t\t// Renderer will choose webGL if supported and failover to canvas\r\n\t\t// For only canvas renderer use forceCanvas option but only supported with pixi-legacy module\r\n\t\t// alternatively can use PIXI.Application\r\n\r\n\t\tconst pixiRender = PIXI.autoDetectRenderer({\r\n\t\t\twidth: dimensions.width,\r\n\t\t\theight: dimensions.height,\r\n\t\t\tantialias: true,\r\n\t\t\ttransparent: true,\r\n\t\t\tforceCanvas: renderer === Renderers.Canvas,\r\n\t\t})\r\n\r\n\t\tconst rendererType =\r\n\t\t\tpixiRender.type === PIXI.RENDERER_TYPE.CANVAS ? 'CANVAS' : 'WEBGL'\r\n\t\tconsole.log(`pixiRenderer flavor: ${rendererType}`)\r\n\r\n\t\treturn pixiRender\r\n\t}\r\n\r\n\tpublic getRendererType(): Renderers {\r\n\t\treturn this.rendererType\r\n\t}\r\n\r\n\tpublic setTooltipElement(element: HTMLDivElement | null) {\r\n\t\tif (this.ToolTipManagerInstance) {\r\n\t\t\tthis.ToolTipManagerInstance.setTooltipElement(element)\r\n\t\t}\r\n\t}\r\n\tpublic setTooltipDetails(dogMap?: DogMap) {\r\n\t\tif (this.ToolTipManagerInstance) {\r\n\t\t\tthis.ToolTipManagerInstance.setDogMap(dogMap)\r\n\t\t}\r\n\t}\r\n\r\n\tpublic updateChart(data: Data[]) {\r\n\t\tthis.updateTransition(data)\r\n\t}\r\n\r\n\tpublic remove() {\r\n\t\tif (this.renderer) {\r\n\t\t\tthis.spriteKeys = new Set([])\r\n\t\t\tthis.spriteMap = {}\r\n\t\t\tthis.stage.destroy({ children: true })\r\n\t\t\tthis.pixiElement.removeChild(this.renderer.view)\r\n\t\t\tthis.renderer.destroy(true)\r\n\t\t\tthis.renderer = null\r\n\t\t}\r\n\t}\r\n\r\n\t// More info on managing pixi sprites for improving performance\r\n\t// https://stackoverflow.com/questions/33437002/pixi-js-animate-circle-improving-performance\r\n\tprivate enter(data: Data[]) {\r\n\t\tif (data) {\r\n\t\t\t// Set the sprite map up once\r\n\t\t\tdata.forEach(node => {\r\n\t\t\t\tconst sprite = new PIXI.Sprite(this.circleTexture)\r\n\t\t\t\tconst posAttrs = {\r\n\t\t\t\t\tx: node.x - radius,\r\n\t\t\t\t\ty: node.y - radius,\r\n\t\t\t\t\thex: node.hex,\r\n\t\t\t\t\tnode,\r\n\t\t\t\t}\r\n\t\t\t\tthis.mapSpriteProps(sprite, posAttrs, radius)\r\n\r\n\t\t\t\tconst key = `${node.id}`\r\n\t\t\t\tsprite.name = key\r\n\t\t\t\t// map sprite key with sprite\r\n\t\t\t\tthis.spriteMap[key] = { sprite, _data: posAttrs }\r\n\t\t\t\t// setting sprite interactive allows for mouse events\r\n\t\t\t\tsprite.interactive = true\r\n\t\t\t\tsprite.interactiveChildren = true\r\n\t\t\t\tsprite.on('mouseover', (ev: any) => this.handleMouseover(ev, key))\r\n\t\t\t\tsprite.on('mouseout', (ev: any) => this.handleMouseout(ev, key))\r\n\t\t\t\tthis.spriteKeys.add(key)\r\n\t\t\t\tthis.nodesStage.addChild(sprite)\r\n\t\t\t})\r\n\t\t\tthis.renderPixi()\r\n\t\t}\r\n\t}\r\n\r\n\tprivate handleMouseover(ev: PIXI.InteractionEvent, nodeId: string) {\r\n\t\tev.stopPropagation()\r\n\r\n\t\tif (this.spriteMap[nodeId] && this.ToolTipManagerInstance) {\r\n\t\t\tconst { sprite, _data } = this.spriteMap[nodeId]\r\n\t\t\tconst coords = [_data.x, _data.y] as [number, number]\r\n\t\t\tthis.ToolTipManagerInstance.showToolTip(_data.node.id, coords)\r\n\t\t\tconst hoverColor = '#2e78ce'\r\n\t\t\tsprite.height = 20\r\n\t\t\tsprite.width = 20\r\n\t\t\tsprite.tint = parseInt(hoverColor.replace('#', ''), 16)\r\n\t\t}\r\n\r\n\t\tthis.renderPixi()\r\n\t\tev.stopPropagation()\r\n\t}\r\n\r\n\tprivate handleMouseout(ev: PIXI.InteractionEvent, nodeId: string) {\r\n\t\tev.stopPropagation()\r\n\t\tif (this.ToolTipManagerInstance) {\r\n\t\t\tthis.ToolTipManagerInstance.hideTooltip()\r\n\t\t}\r\n\t\tif (this.spriteMap[nodeId]) {\r\n\t\t\tconst { sprite, _data } = this.spriteMap[nodeId]\r\n\t\t\tconst defaultColor = _data.hex\r\n\t\t\tif (defaultColor) {\r\n\t\t\t\tsprite.tint = defaultColor\r\n\t\t\t}\r\n\t\t\tsprite.height = 4\r\n\t\t\tsprite.width = 4\r\n\t\t}\r\n\r\n\t\tthis.renderPixi()\r\n\t}\r\n\r\n\tprivate mapSpriteProps(\r\n\t\tsprite: PIXI.Sprite,\r\n\t\tcoords: SpriteInternalCoords,\r\n\t\tradius: number,\r\n\t): void {\r\n\t\tsprite.x = coords.x\r\n\t\tsprite.y = coords.y\r\n\t\tsprite.width = radius * 2\r\n\t\tsprite.height = radius * 2\r\n\t\tsprite.alpha = 1.0\r\n\t\tsprite.tint = coords.hex\r\n\t}\r\n\r\n\tprivate updateTransition(currentData: Data[]) {\r\n\t\tif (Object.keys(this.spriteMap).length > 0) {\r\n\t\t\tconst startScale = this.tweenedScale\r\n\t\t\tconst targetScale = 1\r\n\t\t\tlet start: number | undefined\r\n\t\t\tconst tweenRender = () => {\r\n\t\t\t\tif (start === undefined) {\r\n\t\t\t\t\tstart = Date.now()\r\n\t\t\t\t}\r\n\t\t\t\tconst deltaTime = Date.now() - start\r\n\t\t\t\tconst percent = Math.max(0, Math.min(deltaTime / duration, 1)) // add min to not \"overshoot\" value\r\n\t\t\t\tconst eased = easeCubic(percent)\r\n\t\t\t\tconst finalScale = startScale + (targetScale - startScale) * eased\r\n\t\t\t\t// track which ones need to be visible\r\n\t\t\t\tconst spriteQueue = this.spriteKeys\r\n\t\t\t\tconst nodesToAdd: Data[] = []\r\n\t\t\t\tcurrentData.forEach(currNode => {\r\n\t\t\t\t\tconst spriteKey = `${currNode.id}`\r\n\t\t\t\t\tif (this.spriteMap[spriteKey]) {\r\n\t\t\t\t\t\tconst { sprite, _data } = this.spriteMap[spriteKey]\r\n\t\t\t\t\t\tconst currNodePos = {\r\n\t\t\t\t\t\t\tx: currNode.x - radius,\r\n\t\t\t\t\t\t\ty: currNode.y - radius,\r\n\t\t\t\t\t\t\thex: currNode.hex,\r\n\t\t\t\t\t\t\tnode: currNode,\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst prevNode = _data\r\n\r\n\t\t\t\t\t\tspriteQueue.delete(spriteKey)\r\n\t\t\t\t\t\tsprite.visible = true\r\n\t\t\t\t\t\tthis.mapSpriteProps(sprite, currNodePos, radius)\r\n\r\n\t\t\t\t\t\tconst x = eased * (currNodePos.x - prevNode.x) + prevNode.x\r\n\t\t\t\t\t\tconst y = eased * (currNodePos.y - prevNode.y) + prevNode.y\r\n\t\t\t\t\t\tsprite.x = x - radius\r\n\t\t\t\t\t\tsprite.y = (y! - radius) * finalScale\r\n\t\t\t\t\t\tif (percent >= 1) {\r\n\t\t\t\t\t\t\tthis.spriteMap[spriteKey]._data = currNodePos\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (percent >= 1) {\r\n\t\t\t\t\t\t\t// add for this first time\r\n\t\t\t\t\t\t\tnodesToAdd.push(currNode)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tif (percent >= 1) {\r\n\t\t\t\t\tspriteQueue.forEach((id: string) => {\r\n\t\t\t\t\t\tconst sprite = this.spriteMap[id].sprite as PIXI.Sprite\r\n\t\t\t\t\t\tsprite.visible = false\r\n\t\t\t\t\t})\r\n\t\t\t\t\tif (nodesToAdd.length > 0) {\r\n\t\t\t\t\t\tthis.enter(nodesToAdd)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.tweenedScale = finalScale\r\n\t\t\t\tthis.renderPixi()\r\n\t\t\t\tif (percent < 1.0) {\r\n\t\t\t\t\trequestAnimationFrame(tweenRender)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\trequestAnimationFrame(tweenRender)\r\n\t\t} else {\r\n\t\t\tthis.enter(currentData)\r\n\t\t}\r\n\t}\r\n\r\n\tpublic resize = (width: number, height: number) => {\r\n\t\tthis.dimensions.height = height\r\n\t\tthis.dimensions.width = width\r\n\t\tif (this.renderer) {\r\n\t\t\tthis.renderer.resize(width, height)\r\n\t\t}\r\n\t}\r\n\tprivate renderPixi() {\r\n\t\t// render the stage\r\n\t\tif (this.renderer) {\r\n\t\t\tthis.renderer.render(this.stage)\r\n\t\t}\r\n\t}\r\n}\r\nexport default PixiRenderer\r\n","import React, { memo, useRef } from 'react'\r\nimport { usePixiInstance } from './hooks/usePixiInstance'\r\nimport { useUpdatedData } from './hooks/useUpdatedData'\r\nimport styled from 'styled-components'\r\nimport { useCallbackRef } from '../hooks/useCallbackRef'\r\nimport { DogMap } from '../../../types/data'\r\nimport { ScaleBand, ScaleLinear } from 'd3-scale'\r\nimport { BeeSwarmContainer } from '../SVG/BeeSwarmSVG'\r\nimport { Data } from '../types'\r\nimport { Renderers } from '../../Controls/RendererControls/constants'\r\n\r\nexport interface PixiBeeSwarmProps {\r\n\tdata: Data[]\r\n\twidth: number\r\n\theight: number\r\n\tvpHeight: number\r\n\tvpWidth: number\r\n\trenderer: Renderers\r\n\tyScale: ScaleBand<string>\r\n\txScale: ScaleLinear<number, number>\r\n\tdetails?: DogMap\r\n}\r\n\r\nexport const PixiBeeSwarm: React.FC<PixiBeeSwarmProps> = memo(\r\n\tfunction PixiBeeSwarm({\r\n\t\tdata,\r\n\t\twidth,\r\n\t\theight,\r\n\t\tvpWidth,\r\n\t\tvpHeight,\r\n\t\trenderer,\r\n\t\txScale,\r\n\t\tyScale,\r\n\t\tdetails,\r\n\t}: PixiBeeSwarmProps) {\r\n\t\tconst tooltip = useRef<HTMLDivElement | null>(null)\r\n\t\tconst [setCanvasElement, canvasElement] = useCallbackRef<HTMLDivElement>()\r\n\r\n\t\t// setup pixi instance\r\n\t\tconst pixiInstance = usePixiInstance({\r\n\t\t\twidth,\r\n\t\t\theight,\r\n\t\t\ttoolTipElement: tooltip.current,\r\n\t\t\tcontainerElement: canvasElement,\r\n\t\t\trenderer,\r\n\t\t\tdetails,\r\n\t\t})\r\n\t\t// update sprites with new data\r\n\t\tuseUpdatedData({ data, pixiInstance, renderer })\r\n\r\n\t\t// reuse BeeSwarmContainer with Pixi version and only draw axis\r\n\t\treturn (\r\n\t\t\t<ChartStyle>\r\n\t\t\t\t<BeeSwarmContainer\r\n\t\t\t\t\tdata={[]}\r\n\t\t\t\t\twidth={width}\r\n\t\t\t\t\tvpHeight={vpHeight}\r\n\t\t\t\t\tvpWidth={vpWidth}\r\n\t\t\t\t\theight={height}\r\n\t\t\t\t\txScale={xScale}\r\n\t\t\t\t\tyScale={yScale}\r\n\t\t\t\t\tshowData={false}\r\n\t\t\t\t/>\r\n\t\t\t\t<PixiElement ref={setCanvasElement} className=\"canvas-ref\" />\r\n\t\t\t\t<ToolTip ref={tooltip} className=\"tooltip-ref\" />\r\n\t\t\t</ChartStyle>\r\n\t\t)\r\n\t},\r\n)\r\n\r\nconst ChartStyle = styled.div`\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\tposition: relative;\r\n`\r\n\r\nconst ToolTip = styled.div`\r\n\tz-index: 3;\r\n\tposition: absolute;\r\n\tvisibility: hidden;\r\n\tmax-width: 100px;\r\n`\r\nconst PixiElement = styled.div`\r\n\tz-index: 2;\r\n\tposition: absolute;\r\n`\r\n","import { useEffect } from 'react'\r\nimport PixiRenderer from '../PixiRenderer'\r\nimport { Data } from '../../types'\r\nimport { Renderers } from '../../../Controls/RendererControls/constants'\r\n\r\ninterface UpdateProps {\r\n\tdata: Data[]\r\n\tpixiInstance: PixiRenderer | undefined\r\n\trenderer: Renderers\r\n}\r\nexport function useUpdatedData({ data, pixiInstance, renderer }: UpdateProps) {\r\n\tuseEffect(() => {\r\n\t\tif (pixiInstance && pixiInstance.getRendererType() === renderer) {\r\n\t\t\tpixiInstance.updateChart(data)\r\n\t\t}\r\n\t}, [data, pixiInstance, renderer])\r\n}\r\n","import { useState, useEffect, useMemo, useCallback } from 'react'\r\nimport PixiRenderer from '../PixiRenderer'\r\nimport { Dimensions } from '../../../../utils/types'\r\nimport { DogMap } from '../../../../types/data'\r\nimport { Renderers } from '../../../Controls/RendererControls/constants'\r\n\r\nexport interface PixiInstance {\r\n\tcontainerElement: HTMLDivElement | null\r\n\ttoolTipElement: HTMLDivElement | null\r\n\twidth: number\r\n\theight: number\r\n\trenderer: Renderers\r\n\tdetails?: DogMap\r\n}\r\n\r\nexport function usePixiInstance({\r\n\twidth,\r\n\theight,\r\n\ttoolTipElement,\r\n\tcontainerElement,\r\n\trenderer,\r\n\tdetails,\r\n}: // events,\r\nPixiInstance): PixiRenderer | undefined {\r\n\tconst [pixiInstance, setPixiInstance] = useState<PixiRenderer | undefined>()\r\n\r\n\t// resize canvas on dimension change\r\n\tconst dimensions: Dimensions = useMemo(() => {\r\n\t\tif (pixiInstance) {\r\n\t\t\tpixiInstance.resize(width, height)\r\n\t\t}\r\n\t\treturn { width, height }\r\n\t}, [width, height, pixiInstance])\r\n\r\n\t// update toolTipElement in PixiRenderer\r\n\tuseMemo(() => {\r\n\t\tif (pixiInstance && toolTipElement !== null) {\r\n\t\t\tpixiInstance.setTooltipElement(toolTipElement)\r\n\t\t}\r\n\t}, [toolTipElement, pixiInstance])\r\n\tuseMemo(() => {\r\n\t\tif (pixiInstance) {\r\n\t\t\tpixiInstance.setTooltipDetails(details)\r\n\t\t}\r\n\t}, [details, pixiInstance])\r\n\r\n\tconst setUpPixi = useCallback(\r\n\t\t(instance?: PixiRenderer) => {\r\n\t\t\tif (!instance && containerElement !== null) {\r\n\t\t\t\tconst PIXIinstance = new PixiRenderer(\r\n\t\t\t\t\tcontainerElement,\r\n\t\t\t\t\ttoolTipElement,\r\n\t\t\t\t\tdimensions,\r\n\t\t\t\t\trenderer,\r\n\t\t\t\t)\r\n\t\t\t\tsetPixiInstance(PIXIinstance)\r\n\t\t\t}\r\n\t\t},\r\n\t\t[containerElement, toolTipElement, dimensions, renderer],\r\n\t)\r\n\tuseEffect(() => {\r\n\t\tif (pixiInstance) {\r\n\t\t\tconst currentRenderer = pixiInstance.getRendererType()\r\n\t\t\tif (currentRenderer !== renderer) {\r\n\t\t\t\tpixiInstance.remove()\r\n\t\t\t\tsetUpPixi()\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tsetUpPixi(pixiInstance)\r\n\t\t}\r\n\t}, [pixiInstance, renderer, setUpPixi])\r\n\r\n\treturn pixiInstance\r\n}\r\n","import React, { memo, useMemo } from 'react'\r\nimport { FilterYOptions, DogDescriptionItem, DogMap } from '../../types/data'\r\nimport styled from 'styled-components'\r\nimport { useViewportDimensions } from './hooks/useViewportDimensions'\r\nimport { SVGBeeSwarm } from './SVG'\r\nimport { useYRange, useXRange } from './hooks/range'\r\nimport { useYScale, useXScale } from './hooks/scales'\r\nimport { useTransformedData } from './hooks/useTransformedData'\r\nimport { PixiBeeSwarm } from './Pixi'\r\nimport { Renderers } from '../Controls/RendererControls/constants'\r\n\r\nexport interface ChartContainerProps {\r\n\tdata: DogDescriptionItem[]\r\n\twidth: number\r\n\theight: number\r\n\tyAxisFilter: FilterYOptions\r\n\trenderer: Renderers\r\n\tselectedMax: number\r\n\tdetails?: DogMap\r\n}\r\n\r\nexport const ChartContainer: React.FC<ChartContainerProps> = memo(\r\n\tfunction ChartContainer({\r\n\t\tdata,\r\n\t\twidth,\r\n\t\theight,\r\n\t\tyAxisFilter,\r\n\t\trenderer,\r\n\t\tselectedMax,\r\n\t\tdetails,\r\n\t}: ChartContainerProps) {\r\n\t\t// Move scale setup here to use for both SVG/WebGL implementation\r\n\t\tconst [vpWidth, vpHeight] = useViewportDimensions(width, height)\r\n\t\tconst yRange = useYRange(yAxisFilter)\r\n\t\tconst xRange = useXRange(details)\r\n\t\tconst xScale = useXScale(xRange, vpWidth)\r\n\t\tconst yScale = useYScale(yRange, vpHeight)\r\n\t\tconst heightMapData = useTransformedData({\r\n\t\t\tdata,\r\n\t\t\tyScale,\r\n\t\t\tvpHeight,\r\n\t\t\tvpWidth,\r\n\t\t\tyAxisFilter,\r\n\t\t\tselectedMax,\r\n\t\t})\r\n\r\n\t\tconst chart = useMemo(() => {\r\n\t\t\treturn renderer === Renderers.SVG ? (\r\n\t\t\t\t<SVGBeeSwarm\r\n\t\t\t\t\twidth={width}\r\n\t\t\t\t\tvpHeight={vpHeight}\r\n\t\t\t\t\tvpWidth={vpWidth}\r\n\t\t\t\t\theight={height}\r\n\t\t\t\t\tdata={heightMapData}\r\n\t\t\t\t\tyScale={yScale}\r\n\t\t\t\t\txScale={xScale}\r\n\t\t\t\t\tdetails={details}\r\n\t\t\t\t/>\r\n\t\t\t) : (\r\n\t\t\t\t<PixiBeeSwarm\r\n\t\t\t\t\twidth={width}\r\n\t\t\t\t\tvpHeight={vpHeight}\r\n\t\t\t\t\tvpWidth={vpWidth}\r\n\t\t\t\t\theight={height}\r\n\t\t\t\t\tdata={heightMapData}\r\n\t\t\t\t\trenderer={renderer}\r\n\t\t\t\t\tyScale={yScale}\r\n\t\t\t\t\txScale={xScale}\r\n\t\t\t\t\tdetails={details}\r\n\t\t\t\t/>\r\n\t\t\t)\r\n\t\t}, [\r\n\t\t\twidth,\r\n\t\t\theight,\r\n\t\t\tvpHeight,\r\n\t\t\tvpWidth,\r\n\t\t\theightMapData,\r\n\t\t\trenderer,\r\n\t\t\tyScale,\r\n\t\t\tdetails,\r\n\t\t\txScale,\r\n\t\t])\r\n\r\n\t\treturn <ChartStyle>{chart}</ChartStyle>\r\n\t},\r\n)\r\n\r\nconst ChartStyle = styled.div`\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\tposition: relative;\r\n\tdisplay: inline-flex;\r\n`\r\n","import { useMemo } from 'react'\r\nimport {\r\n\tCoatYRange,\r\n\tGenderYRange,\r\n\tSizeYRange,\r\n\tFilterYOptions,\r\n\tDogMap,\r\n} from '../../../types/data'\r\n\r\n// Get X Extent\r\nexport function useXRange(dogMap?: DogMap): [number, number] {\r\n\treturn useMemo(() => {\r\n\t\tif (dogMap) {\r\n\t\t\tconst maxAge = Object.keys(dogMap).reduce((acc, id) => {\r\n\t\t\t\tconst details = dogMap[id]\r\n\t\t\t\tif (details.age > acc) {\r\n\t\t\t\t\tacc = details.age\r\n\t\t\t\t}\r\n\t\t\t\treturn acc\r\n\t\t\t}, 0 as number)\r\n\t\t\treturn [0, maxAge]\r\n\t\t}\r\n\t\treturn [0, 0]\r\n\t}, [dogMap])\r\n}\r\n\r\n// Get Y Bands\r\nexport function useYRange(yFilter: FilterYOptions): string[] {\r\n\treturn useMemo(() => {\r\n\t\t// we could iterate over the data and get a set of all y values\r\n\t\t// but instead this is precomputed in types\r\n\t\tswitch (yFilter) {\r\n\t\t\tcase FilterYOptions.coat:\r\n\t\t\t\treturn CoatYRange\r\n\t\t\tcase FilterYOptions.gender:\r\n\t\t\t\treturn GenderYRange\r\n\t\t\tcase FilterYOptions.size:\r\n\t\t\t\treturn SizeYRange\r\n\t\t\tdefault:\r\n\t\t\t\treturn []\r\n\t\t}\r\n\t}, [yFilter])\r\n}\r\n","import { useMemo } from 'react'\r\nimport { correctedMargins } from '../constants'\r\n\r\nexport function useViewportDimensions(\r\n\twidth: number,\r\n\theight: number,\r\n): [number, number] {\r\n\tconst vpWidth = useMemo(\r\n\t\t() => width - correctedMargins.left - correctedMargins.right,\r\n\t\t[width],\r\n\t)\r\n\tconst vpHeight = useMemo(\r\n\t\t() => height - correctedMargins.top - correctedMargins.bottom,\r\n\t\t[height],\r\n\t)\r\n\treturn [vpWidth, vpHeight]\r\n}\r\n","import { useMemo } from 'react'\r\nimport { scaleLinear, ScaleLinear, ScaleBand, scaleBand } from 'd3-scale'\r\nimport { correctedMargins } from '../constants'\r\n\r\nexport function useXScale(\r\n\t[min, max]: [number, number],\r\n\tvpWidth: number,\r\n): ScaleLinear<number, number> {\r\n\treturn useMemo(() => {\r\n\t\treturn scaleLinear().domain([min, max]).range([0, vpWidth])\r\n\t}, [min, max, vpWidth])\r\n}\r\n\r\nexport function useYScale(\r\n\tyRange: string[],\r\n\tvpHeight: number,\r\n): ScaleBand<string> {\r\n\treturn useMemo(() => {\r\n\t\tconst yScale = scaleBand()\r\n\t\t\t.domain(yRange)\r\n\t\t\t.range([vpHeight, correctedMargins.top])\r\n\t\treturn yScale\r\n\t}, [vpHeight, yRange])\r\n}\r\n","import React, { memo, useCallback, useState } from 'react'\r\nimport { Page } from '../../common/styled'\r\nimport styled from 'styled-components'\r\nimport { useStateSelection } from '../../hooks/useStateSelection'\r\nimport { DogDescriptionItem, DogMap } from '../../types/data'\r\nimport { Header } from '../Header'\r\nimport { Footer } from '../Footer'\r\nimport { Controls } from '../Controls/Controls'\r\nimport { SizedToParent } from '../../utils/SizedToParent'\r\nimport { Dimensions } from '../../utils/types'\r\nimport { ChartContainer } from '../Chart'\r\nimport { useRendererSelection } from '../../hooks/UseRendererSelection'\r\nimport { useSliderSettings } from '../../hooks/useSliderSettings'\r\nconst sizeStyles = { overflowY: 'hidden' } as React.CSSProperties\r\n\r\nexport interface VisualizePageProps {\r\n\tdata: DogDescriptionItem[]\r\n\tdetails?: DogMap\r\n}\r\nexport const VisualizePage: React.FC<VisualizePageProps> = memo(\r\n\tfunction VisualizePage({ data, details }) {\r\n\t\t// get dimensions from ref\r\n\t\tconst [chartDimensions, setChartDimensions] = useState<\r\n\t\t\tDimensions | undefined\r\n\t\t>(undefined)\r\n\r\n\t\tconst handleResize = useCallback(\r\n\t\t\t({ width, height }) => {\r\n\t\t\t\tsetChartDimensions({ width, height })\r\n\t\t\t},\r\n\t\t\t[setChartDimensions],\r\n\t\t)\r\n\r\n\t\tconst [selectedRenderer, onRendererChange] = useRendererSelection()\r\n\t\t// handle events and selection for dropdown\r\n\t\tconst [yAxisFilter, onYDropDrownChange] = useStateSelection()\r\n\t\t// Map selected data values based on selections and get data bounds\r\n\t\tconst { selectedMax, sliderSettings, onSliderChange } = useSliderSettings(\r\n\t\t\tdata,\r\n\t\t)\r\n\t\treturn (\r\n\t\t\t<Container>\r\n\t\t\t\t<Selections>\r\n\t\t\t\t\t<Header />\r\n\t\t\t\t\t<Controls\r\n\t\t\t\t\t\tyAxisFilter={yAxisFilter}\r\n\t\t\t\t\t\tonSliderChange={onSliderChange}\r\n\t\t\t\t\t\tselectedMax={selectedMax}\r\n\t\t\t\t\t\tsliderSettings={sliderSettings}\r\n\t\t\t\t\t\tonYDropDrownChange={onYDropDrownChange}\r\n\t\t\t\t\t\tselectedRender={selectedRenderer}\r\n\t\t\t\t\t\tonRendererChange={onRendererChange}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Selections>\r\n\t\t\t\t<Chart>\r\n\t\t\t\t\t<SizedToParent style={sizeStyles} onResize={handleResize}>\r\n\t\t\t\t\t\t{chartDimensions ? (\r\n\t\t\t\t\t\t\t<ChartContainer\r\n\t\t\t\t\t\t\t\twidth={chartDimensions.width}\r\n\t\t\t\t\t\t\t\theight={chartDimensions.height}\r\n\t\t\t\t\t\t\t\tdata={data}\r\n\t\t\t\t\t\t\t\tyAxisFilter={yAxisFilter}\r\n\t\t\t\t\t\t\t\trenderer={selectedRenderer}\r\n\t\t\t\t\t\t\t\tdetails={details}\r\n\t\t\t\t\t\t\t\tselectedMax={selectedMax}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<></>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</SizedToParent>\r\n\t\t\t\t</Chart>\r\n\t\t\t\t<Footer />\r\n\t\t\t</Container>\r\n\t\t)\r\n\t},\r\n)\r\n\r\nconst Container = styled(Page)`\r\n\tmargin: 0;\r\n\tpadding: 0;\r\n\tposition: relative;\r\n\tmax-height: 100%;\r\n\tmax-width: 100%;\r\n\tmin-height: 400px;\r\n`\r\nconst Chart = styled.div`\r\n\tposition: relative;\r\n\tflex: 1;\r\n\tmargin-top: 50px;\r\n`\r\nconst Selections = styled.div`\r\n\tposition: relative;\r\n\tdisplay: block;\r\n`\r\n","import { useState, useCallback, FormEvent } from 'react'\r\nimport { IChoiceGroupOption } from '@fluentui/react'\r\nimport { Renderers } from '../components/Controls/RendererControls/constants'\r\n\r\nexport function useRendererSelection(): [\r\n\tRenderers,\r\n\t(\r\n\t\tevent: FormEvent<HTMLElement | HTMLInputElement> | undefined,\r\n\t\toption?: IChoiceGroupOption,\r\n\t) => void,\r\n] {\r\n\tconst [selectedRenderer, setSelectedRenderer] = useState<Renderers>(\r\n\t\tRenderers.WebGL,\r\n\t)\r\n\r\n\tconst onRendererChange = useCallback(\r\n\t\t(\r\n\t\t\tev: FormEvent<HTMLElement | HTMLInputElement> | undefined,\r\n\t\t\toption?: IChoiceGroupOption,\r\n\t\t) => {\r\n\t\t\tif (option) {\r\n\t\t\t\tsetSelectedRenderer(option.key as Renderers)\r\n\t\t\t}\r\n\t\t},\r\n\t\t[setSelectedRenderer],\r\n\t)\r\n\r\n\treturn [selectedRenderer, onRendererChange]\r\n}\r\n","import { DogDescriptionItem } from '../types/data'\r\nimport { useMemo, useState, useCallback } from 'react'\r\nexport interface SliderSettings {\r\n\tmin: number\r\n\tmax: number\r\n}\r\ninterface DataBounds {\r\n\tselectedMax: number\r\n\tsliderSettings: SliderSettings\r\n\tonSliderChange: (value: number) => void\r\n}\r\n\r\nexport function useSliderSettings(data: DogDescriptionItem[]): DataBounds {\r\n\tconst [selectedMax, setSelectedMax] = useState<number>(data.length)\r\n\r\n\tconst sliderSettings = useMemo(() => {\r\n\t\treturn { min: 500, max: data.length }\r\n\t}, [data])\r\n\t// slice the data according to slider value\r\n\r\n\tconst onSliderChange = useCallback(\r\n\t\t(value: number) => {\r\n\t\t\tsetSelectedMax(value)\r\n\t\t},\r\n\t\t[setSelectedMax],\r\n\t)\r\n\treturn {\r\n\t\tselectedMax,\r\n\t\tsliderSettings,\r\n\t\tonSliderChange,\r\n\t}\r\n}\r\n","import React, { memo } from 'react'\r\nimport styled from 'styled-components'\r\nimport VisualizePage from '../VisualizePage'\r\nimport { useDogData } from '../../hooks/useDogData'\r\n\r\nexport const IndexPage: React.FC = memo(function IndexPage() {\r\n\tconst [data, details] = useDogData()\r\n\treturn data ? (\r\n\t\t<Container>\r\n\t\t\t<VisualizePage data={data} details={details} />{' '}\r\n\t\t</Container>\r\n\t) : (\r\n\t\t<Loading>\r\n\t\t\t<iframe\r\n\t\t\t\tsrc=\"https://giphy.com/embed/gfl7CKcgs6exW\"\r\n\t\t\t\twidth=\"480\"\r\n\t\t\t\theight=\"384\"\r\n\t\t\t\tframeBorder=\"0\"\r\n\t\t\t\tclassName=\"giphy-embed\"\r\n\t\t\t\tallowFullScreen={false}\r\n\t\t\t\ttitle=\"talking dog\"\r\n\t\t\t></iframe>\r\n\t\t\t<h1>loading data... please hold ❤ ❤ ❤</h1>\r\n\t\t</Loading>\r\n\t)\r\n})\r\n\r\nexport default IndexPage\r\n\r\nconst Container = styled.div`\r\n\tdisplay: flex;\r\n\tflex: 1;\r\n\theight: 100%;\r\n\twidth: 100%;\r\n\tfont-family: 'Gaegu', cursive;\r\n`\r\nconst Loading = styled.div`\r\n\tposition: relative;\r\n\tdisplay: block;\r\n\tfont-family: 'Gaegu', cursive;\r\n\tmargin-left: 40%;\r\n\tmargin-top: 20%;\r\n`\r\n","import { useMemo, useState } from 'react'\r\nimport { DogDescriptionItem, DogMap } from '../types/data'\r\n// Data Gathered from\r\n// https://github.com/the-pudding/data/tree/master/dog-shelters\r\n// under MIT license\r\n\r\nconst postionFile =\r\n\t'https://raw.githubusercontent.com/ahoak/pixi-svg-visualization/main/data/dog-data.json'\r\nconst detailsFile =\r\n\t'https://raw.githubusercontent.com/ahoak/pixi-svg-visualization/main/data/dog-map.json'\r\n\r\nexport function useDogData(): [\r\n\tDogDescriptionItem[] | undefined,\r\n\tDogMap | undefined,\r\n] {\r\n\tconst [aggregatedDogData, setAggregatedDogData] = useState<\r\n\t\tDogDescriptionItem[] | undefined\r\n\t>()\r\n\tconst [mapDogData, setMapDogData] = useState<DogMap | undefined>()\r\n\r\n\tuseMemo(async () => {\r\n\t\tif (!aggregatedDogData) {\r\n\t\t\tconst parseData = await (await fetch(postionFile)).json()\r\n\t\t\tconsole.log(parseData)\r\n\t\t\tsetAggregatedDogData(parseData)\r\n\t\t}\r\n\t}, [aggregatedDogData])\r\n\r\n\tuseMemo(async () => {\r\n\t\tif (!mapDogData) {\r\n\t\t\tconst parseData = await (await fetch(detailsFile)).json()\r\n\t\t\tsetMapDogData(parseData)\r\n\t\t}\r\n\t}, [mapDogData])\r\n\treturn [aggregatedDogData, mapDogData]\r\n}\r\n","import { createTheme } from '@fluentui/react'\r\n\r\n// Yay pink!\r\nexport const pinkTheme = createTheme({\r\n\tdefaultFontStyle: { fontFamily: \"'Gaegu', cursive\", fontSize: '20px' },\r\n\tpalette: {\r\n\t\tthemePrimary: '#f683ba',\r\n\t\tthemeLighterAlt: '#0a0507',\r\n\t\tthemeLighter: '#27151e',\r\n\t\tthemeLight: '#492738',\r\n\t\tthemeTertiary: '#934e6f',\r\n\t\tthemeSecondary: '#d772a3',\r\n\t\tthemeDarkAlt: '#f68ec0',\r\n\t\tthemeDark: '#f79fca',\r\n\t\tthemeDarker: '#f9b8d7',\r\n\t\tneutralLighterAlt: '#000000',\r\n\t\tneutralLighter: '#000000',\r\n\t\tneutralLight: '#000000',\r\n\t\tneutralQuaternaryAlt: '#000000',\r\n\t\tneutralQuaternary: '#000000',\r\n\t\tneutralTertiaryAlt: '#b30474',\r\n\t\tneutralTertiary: '#c8c8c8',\r\n\t\tneutralSecondary: '#d0d0d0',\r\n\t\tneutralPrimaryAlt: '#dadada',\r\n\t\tneutralPrimary: '#ffffff',\r\n\t\tneutralDark: '#f4f4f4',\r\n\t\tblack: '#f8f8f8',\r\n\t\twhite: '#000000',\r\n\t},\r\n})\r\n","import React, { memo, StrictMode } from 'react'\r\nimport IndexPage from '../IndexPage'\r\nimport { createGlobalStyle } from 'styled-components'\r\nimport './font.css'\r\nimport { loadTheme } from '@fluentui/react'\r\nimport { pinkTheme } from '../../common/theme'\r\nloadTheme(pinkTheme)\r\nconst App: React.FC = memo(function App() {\r\n\treturn (\r\n\t\t<StrictMode>\r\n\t\t\t<GlobalStyle />\r\n\t\t\t<IndexPage />\r\n\t\t</StrictMode>\r\n\t)\r\n})\r\nexport default App\r\n\r\nconst GlobalStyle = createGlobalStyle`\r\n\thtml {\r\n\t\theight: 100%;\r\n\t\twidth: 100%;\r\n\t\tmax-height: 100%;\r\n\t\tmax-width: 100%;\r\n\t\tdisplay: flex;\r\n\t}\r\n  body {\r\n\t\tdisplay: flex;\r\n\t\tflex: 1;\r\n\t\tmargin: 0;\r\n\t\t-webkit-font-smoothing: antialiased;\r\n\t\t-moz-osx-font-smoothing: grayscale;\r\n\t\toverscroll-behavior: none;\r\n\t\tmax-height: 100%;\r\n\t\tmax-width: 100%;\r\n\t}\r\n\t#root {\r\n\t\tflex: 1;\r\n\t\tdisplay: flex;\r\n\t\tmax-height: 100%;\r\n\t\tmax-width: 100%;\r\n\t\theight: 100%;\r\n\t\twidth: 100%;\r\n\t\tbackground: black;\r\n\t\tcolor: white;\r\n\t}\r\n`\r\n","import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport App from './components/App/App'\r\nReactDOM.render(<App />, document.getElementById('root'))\r\n"],"sourceRoot":""}